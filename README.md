# 🎓 大學個人申請校內報名系統

這是一套校內使用的「大學個人申請」報名系統，以學校 Google 帳號登入後，學生可以選填志願、封存並列印證明；導師可以掌握班級同學的填報狀況。資料儲存在 Google 試算表，維護簡單、流程清楚。

## 📄 建立副本
- 請將 [[大學個人申請校內報名系統](https://docs.google.com/spreadsheets/d/1Ciaef_VL7WAy8aswsPhZpkAa_lrBKJFT29x06Oongg4/copy)]的試算表複製到您自己的 Google 雲端硬碟，複製後檔案名稱可以任意修改 。

## ✨ 功能重點
- 學生報名：選志願、儲存、清空、封存；封存後自動產生 PDF 證明
- 導師查詢：查看班級學生的志願數與填報狀態，支援細節展開
- 成績呈現：學測、英聽、術科，並提供五標比對，一目了然
- 簡約易讀：提供黑/白主題切換，風格簡約力求易讀
- 安全機制：
  > 使用 Google 電子郵件帳號，無須額外管理帳號  
  > 所有操作均需學校 Google 帳號認證，保障資料安全

## 🏗️ 系統架構
- 前端：Apps Script HTML 模板 + Bootstrap 5.3 + Bootstrap Icons
- 後端：Google Apps Script（V8）
- 資料：Google 試算表（多工作表）
- 文件：以 Google Docs 生成 PDF，連結回寫至學生資料

## 🚀 快速上手
- 建立試算表：依下方「必備工作表與欄位」建立各工作表（名稱需一致）
- 匯入資料：將大考中心與甄選委員會提供的原始檔匯入以建立所需的工作表
- 部署網頁應用程式：發布成網頁形式，僅供自己校內學生與教師使用

## 📑 必備工作表與欄位
同一份試算表中請建立以下工作表，欄位名稱採系統既定標題。

- `設定`（系統基本設定）
  - `系統開關`：是否啟用系統（啟用/關閉）
  - `學年度`：顯示在各頁面與證明文件中（例如：114學年度）
  - `學校全銜`：會顯示在頁面標題與證明文件上
  - `系統開放時間`：控制功能開放的開始時間（格式：yyyy/MM/dd HH:mm:ss）
  - `系統關閉時間`：控制功能開放的結束時間（格式：yyyy/MM/dd HH:mm:ss）
  - `校系分則連結規則`：甄選委員會校系分則網址的規則，支援 `(學系代碼)` 自動替換
  - `可選填志願數`：決定系統建立 `志願1..N` 欄位的數量，依甄選會規範
  - `最後可否放棄`：是否允許學生勾選「放棄選填」，可以強迫學生至少選擇1個學系志願（不建議）
  - `無身分未通過檢定不可選填`：沒有相同身分，未通過時則不予選填 (甄選會允許一般生未通過可以報名)
  - `學系志願選填說明`：多行文字，於學生頁顯示操作與規範
  - `一般生費用`：甄選會官方定價，中低收入戶通常為4折
  - `寄發共用通知信`：報名資料確認表雲端硬碟共用時是否寄發通知承辦師長
  - `承辦單位`：顯示於聯絡資訊區（例如：教務處註冊組）
  - `承辦師長`：顯示於聯絡資訊區（例如：註冊組長）
  - `聯絡電話`：顯示於聯絡資訊區，建議含分機
  - `電子郵件`：顯示於聯絡資訊區，供使用者聯絡
  - `自訂版權宣告`：自訂頁尾版權文字（不填則用預設）
  - `贊助廣告開關`：是否顯示贊助區塊（啟用/停用）

- `學生`（學生資料與志願）
  - `最後登入時間`、`登入次數`：學生的使用紀錄
  - `最後儲存時間`：最近一次儲存志願的時間
  - `封存時間`：學生按下封存後系統寫入的時間
  - `放棄時間`：勾選「放棄選填」或逾期視同放棄時寫入
  - `雲端連結`：封存後生成的 PDF 檔案連結
  - `電子郵件`：登入驗證用，必填，需與校內帳號一致
  - `報名序號`：連結至成績與證明（PDF 檔名也會使用）
  - `班級` / `班號`：班級資訊（系統會容錯常見格式）
  - `姓名`、`性別`：基本資料顯示用
  - `報名身分`：代碼 1一般、2原住民生、3離島生、4願景計畫生（顯示時會轉為中文）
  - `優待身分`：代碼 1一般、2低收入戶、3中低收入戶（顯示時會轉為中文）
  - `志願1` … `志願N`：按志願順位填入學系代碼，最多 N 份（N 由 `可選填志願數` 決定）

- `導師`
  - `電子郵件`、`班級`（可多班；支援逗號、頓號、分號、斜線分隔）

> 匯入資料提醒：
> 以下工作表皆由第三方匯入，千萬不要採用複製貼上方式匯入建立，否則會導致以0開頭的學號或校系代碼錯亂，比如學號`010077`會變成`10077`。

- `學測成績`（資料來源：大考中心原始檔）
  - `報名序號` + 各科級分（國文/英文/數A/數B/社會/自然）
  - 只需匯入，不需要進一步整理

- `英聽成績`（資料來源：大考中心原始檔）
  - `報名序號`、`等級`
  - 只需匯入，不需要進一步整理

- `術科成績`（資料來源：大考中心原始檔）
  - `報名序號`、`音樂組准考證號`、`美術組准考證號`、`體育組准考證號`、`考區`
  - 只需匯入，不需要進一步整理

- `學測五標`（資料來源：大考中心原始檔）
  - `科目`、`頂標`、`前標`、`均標`、`後標`、`底標`
  - 只需匯入，不需要進一步整理

- `大學資料`（資料來源：甄選委員會原始檔）
  - `代碼`、`學校名稱`、`限填校系數`
  - 只需匯入，不需要進一步整理

- `校系資料`（資料來源：甄選委員會原始檔）
  - `學系代碼`、`學系名稱`、`選填限制`、`校系編組`
  - 只需匯入，不需要進一步整理

- `限填一組`（資料來源：甄選委員會原始檔）
  - 匯入甄選會提供的「限填一組或特殊報名限制校系一覽表」
  - 匯入前請自行將PDF檔案轉成EXCEL格式
  - 請利用上方功能選單`整理限填一組工作表`進行學系編組

## 🧭 功能導覽
- 首頁：顯示學年度與開放期間，進入「學生」或「導師」
- 學生：選擇大學、挑選學系加入志願；支援儲存、清空、封存；封存後可列印證明
- 導師：列出班級學生、志願數與狀態，展開可查看成績與志願細節

## 🛠️ 內建工具（試算表選單）
- `檢查是否有完整的工作表`：運行前，快速檢查必要工作表是否齊全
- `整理限填一組工作表`：自動整理「限填一組」工作表，產生 `校系編組` 欄位

## 🔐 權限與安全
- 僅校內帳號可使用：部署時`誰可以存取`選擇貴校的所有使用者，限制外部帳號連線
- 身分驗證：透過 `Session.getActiveUser().getEmail()` 比對 `學生`/`導師` 身分，無須另外建立帳號管理，安全機制由 Google 為您把關
- PDF：封存後建立 Google 文件並轉成 PDF，設定共用，連結寫回 `雲端連結`

## ©️ 授權與廣告
- 版權採用 MIT License 授權，也容許自訂義版權宣告，如果可以請表彰作者的名字
- 廣告功能，可在 `設定` 工作表啟用/停用，廣告內容由 Google 廣告平台提供，如果可以請保持啟用
