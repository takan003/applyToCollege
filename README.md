# 🎓 大學個人申請校內報名系統

這是一套校內使用的「大學個人申請」報名系統，提供兩種登入機制（推薦採用 Workspace帳號），學生可以選填志願、封存並列印證明。資料儲存在 Google 試算表，維護簡單、流程清楚。

## 📄 建立副本
- 請將 [[大學個人申請校內報名系統](https://docs.google.com/spreadsheets/d/1Ciaef_VL7WAy8aswsPhZpkAa_lrBKJFT29x06Oongg4/copy)]的試算表複製到您自己的 Google 雲端硬碟，複製後檔案名稱可以任意修改 。
> [!IMPORTANT]
> 🔴 截至程式發布為止，試算表中`大學資料`、`校系資料`與`限填一組`工作表內容為`115學年度`，其餘為`114學年度`。

## ✨ 功能重點
- 學生報名：選志願、儲存、清空、封存；封存後自動產生 PDF 證明
- 成績呈現：學測、英聽、術科，並提供五標比對，一目了然
- 簡約易讀：提供黑/白主題切換，風格簡約力求易讀
- 安全機制：
  > Workspace帳號（推薦）：僅機關內使用者可存取  
  > 帳密登入：系統自行控管授權

## 🏗️ 系統架構
- 前端：Apps Script HTML 模板 + Bootstrap 5.3 + Bootstrap Icons
- 後端：Google Apps Script（V8）
- 資料：Google 試算表（多工作表）
- 文件：以 Google Docs 生成 PDF，連結回寫至學生資料

## 🚀 快速上手
- 建立試算表：依下方「必備工作表與欄位」建立各工作表（名稱需一致）
- 匯入資料：將大考中心與甄選委員會提供的原始檔匯入以建立所需的工作表
- 部署網頁應用程式（Workspace帳號／帳密登入）：
  - Workspace帳號（推薦）：`執行身分`選擇「我」，`誰可以存取`選擇「貴校的所有使用者」；前端會檢查網頁用戶是否為貴校的成員，僅機關內帳號可使用
  - 帳密登入：`執行身分`選擇「我」，`誰可以存取`可選擇所有使用者；由用戶於前端輸入帳密等個人資料登入。

## 📑 必備工作表與欄位
同一份試算表中請建立以下工作表，欄位名稱採系統既定標題。

- 設定（系統基本設定）
  - `系統開關`：是否啟用系統（啟用/關閉）
  - `學年度`：顯示在各頁面與證明文件中（例如：114學年度）
  - `學校全銜`：會顯示在頁面標題與證明文件上
  - `系統開放時間`：控制功能開放的開始時間（格式：yyyy/MM/dd HH:mm:ss）
  - `系統關閉時間`：控制功能開放的結束時間（格式：yyyy/MM/dd HH:mm:ss）
  - `校系分則連結規則`：甄選委員會校系分則網址的規則，支援 `(學系代碼)` 自動替換
  - `可選填志願數`：決定系統建立 `志願1..N` 欄位的數量，依甄選會規範
  - `最後可否放棄`：是否允許學生勾選「放棄選填」，可以強迫學生至少選擇1個學系志願（不建議）
  - `無身分未通過檢定不可選填`：沒有相同身分，未通過時則不予選填 (甄選會允許一般生未通過可以報名)
  - `學系志願選填說明`：多行文字，於學生頁顯示操作與規範
  - `一般生費用`：甄選會官方定價，中低收入戶通常為4折
  - `寄發共用通知信`：報名資料確認表雲端硬碟共用時是否寄發通知承辦師長
  - `登入方式`：選擇用戶登入的方式，`Workspace帳號`（推薦）或`帳密登入`
  - `指定用戶自行更更欄位`：指定用戶可以修改哪一個欄位（表單第1-4欄）或不提供修改
  - `密碼規則`：配合前一個欄位，是否啟用密碼規則，啟用時密碼須符合長度至少6碼，英數皆要，英文包含大小寫（啟用/關閉）
  - `承辦單位`：顯示於聯絡資訊區（例如：教務處註冊組）
  - `聯絡電話`：顯示於聯絡資訊區，建議含分機
  - `電子郵件`：顯示於聯絡資訊區，供使用者聯絡
  - `自訂版權宣告`：自訂頁尾版權文字（不填則用預設）
  - `贊助廣告開關`：是否顯示贊助區塊（啟用/關閉）

- 帳密（管理使用者）
  - 欄位總說明：
    - 工作表的預設欄位，每一欄或每一列的順序都可以任意移動
    - `表單第1-4欄`：建立帳密輸入表單的必要欄位，依照需求讓用戶輸入2-4個識別資料登入之用
      - `表單第1-2欄`：基於安全，預設為固定啟用，用戶至少要有兩組資料用來辨識登入身分
      - `表單第3-4欄`：可選用，依需求增加，越多項目越安全，用戶也會越嫌惡
    - `必要欄位1-7攔`：導師、學生識別的必要欄位，或系統紀錄的必要欄位
  - Workspace帳號（推薦）：
    - `簡要說明`：學校使用Workspace服務，提供教師、學生帳號使用時，非常推薦採用此登入方式，帳號權限與安全交由Google管理，不需要額外設定。
    - `必要欄位說明`：
      - `必要欄位1`：身分，限填`學生`/`導師`，登入導向不同功能頁面
      - `必要欄位2`：報名序號，`學生`的必要欄位，學測報名序號，重要的索引欄位
      - `必要欄位3`：班級代碼，`導師`的必要欄位，導師查詢功能識別學生
      - `必要欄位5`：電子郵件，必須提供學校的Workspace帳號，才能登入系統
      - `必要欄位6、7`：系統紀錄用，勿更動
    - `其他欄位說明`：
      - `必要欄位4`：姓名，Workspace帳號登入時，本欄位不重要，提供用戶方便管理資料
      -  `表單第1-4欄`：無作用
  - 帳密登入：
    > 特別功能：
    > - 可以讓用戶修改指定的欄位資料，實踐`變更密碼`的功能
    > - 可以讓用戶註冊電子郵件，藉機收集個人電子郵件，利用電子郵件找回密碼  
    - `簡要說明`：學校未使用Workspace服務，改採自行建立帳號密碼，可以搭配使用者修改密碼來提高安全性。
    - `必要欄位說明`：
      - `表單第1-2欄`：強制啟用，項目提示說明、項目名稱都可以自訂
      - `表單第3-4欄`：可選用，依需求增加，越多項目越安全，用戶也會越嫌惡
      - `必要欄位1`：身分，限填`學生`/`導師`，登入導向不同功能頁面
      - `必要欄位2`：報名序號，`學生`的必要欄位，學測報名序號，重要的索引欄位
      - `必要欄位3`：班級代碼，`導師`的必要欄位，導師查詢功能識別學生
      - `必要欄位4`：姓名，`導師`的必要欄位，導師用戶識別個人資料是否正確
    - `其他欄位說明`：
      - `必要欄位5`：電子郵件，採用戶自行註冊登錄電子郵件，用於忘記密碼功能
      - `必要欄位6、7`：系統紀錄用，勿更動
    - `變更密碼功能說明`：
      - 請將`設定`工作表的`指定用戶自行變更欄位`選為`表單第1-4欄`的其中一欄，表示允許用戶修改該欄未的個人資料，比如密碼欄位
      - 由於變更預設密碼後，用戶可能忘記密碼，同時啟動`註冊電子郵件`與`忘記密碼`功能
      - 搭配`設定`工作表的`密碼規則`，用戶可以修改密碼，且密碼須符合規則

- 學生（存取學生的志願）
  - `最後登入時間`、`登入次數`：學生的使用紀錄
  - `最後儲存時間`：最近一次儲存志願的時間
  - `封存時間`：學生按下封存後系統寫入的時間
  - `放棄時間`：勾選「放棄選填」或逾期視同放棄時寫入
  - `雲端連結`：封存後生成的 PDF 檔案連結
  - `報名序號`：連結至成績與證明（PDF 檔名也會使用）
  - `班級`：班級名稱
  - `班號`：學生的班級座號
  - `姓名`、`性別`：基本資料顯示用
  - `報名身分`：代碼 1一般、2原住民生、3離島生、4願景計畫生（顯示時會轉為中文）
  - `優待身分`：代碼 1一般、2低收入戶、3中低收入戶（顯示時會轉為中文）
  - `志願1` … `志願N`：按志願順位填入學系代碼，最多 N 份（N 由 `可選填志願數` 決定）


> 匯入資料提醒：  
> 以下工作表皆由第三方匯入，千萬不要採用複製貼上方式匯入建立，否則會導致以0開頭的學號或校系代碼錯亂，比如學號`010077`會變成`10077`。

- 學測成績（資料來源：大考中心原始檔）
  - `報名序號` + 各科級分（國文/英文/數A/數B/社會/自然）
  - 只需匯入，不需要進一步整理

- 英聽成績（資料來源：大考中心原始檔）
  - `報名序號`、`等級`
  - 只需匯入，不需要進一步整理

- 術科成績（資料來源：大考中心原始檔）
  - `報名序號`、`音樂組准考證號`、`美術組准考證號`、`體育組准考證號`、`考區`
  - 只需匯入，不需要進一步整理

- 學測五標（資料來源：大考中心原始檔）
  - `科目`、`頂標`、`前標`、`均標`、`後標`、`底標`
  - 只需匯入，不需要進一步整理

- 大學資料（資料來源：甄選委員會原始檔）
  - `代碼`、`學校名稱`、`限填校系數`
  - 只需匯入，不需要進一步整理

- 校系資料（資料來源：甄選委員會原始檔）
  - `學系代碼`、`學系名稱`、`選填限制`、`校系編組`
  - 只需匯入，不需要進一步整理

- 限填一組（資料來源：甄選委員會原始檔）
  - 匯入甄選會提供的「限填一組或特殊報名限制校系一覽表」
  - 匯入前請自行將PDF檔案轉成EXCEL格式
  - 請利用上方功能選單`整理限填一組工作表`進行學系編組

## 🧭 功能導覽
- 首頁：顯示學年度與開放期間，進入「學生」
- 學生：選擇大學、挑選學系加入志願；支援儲存、清空、封存；封存後可列印證明

## 🛠️ 內建工具（試算表選單）
- `檢查是否有完整的工作表`：運行前，快速檢查必要工作表是否齊全
- `整理限填一組工作表`：自動整理「限填一組」工作表，產生 `校系編組` 欄位

## 🔐 權限與安全（Workspace帳號／帳密登入）
- Workspace帳號（推薦）
  - 存取：部署時`誰可以存取`選擇貴校的所有使用者，限制外部帳號
  - 驗證：以 `Session.getActiveUser().getEmail()` 進行校內帳號認證，無須額外管理帳號
  - 授權：依登入者在試算表中的狀態控制功能與資料存取
- 帳密登入
  - 存取：部署時`誰可以存取`可選擇所有使用者，實際權限由系統登入控管
  - 驗證：使用系統內帳密登入機制，登入後依使用者狀態控管功能與資料存取
- PDF：封存後建立 Google 文件並轉成 PDF，設定共用，連結寫回 `雲端連結`

## ©️ 授權與廣告
- 版權採用 MIT License 授權，也容許自訂義版權宣告，如果可以請表彰作者的名字
- 廣告功能，可在 `設定` 工作表啟用/停用，廣告內容由 Google 廣告平台提供，如果可以請保持啟用

## 🙏 致謝
歡迎參觀我的網站 [Gas Station](https://script.google.com/a/macros/gms.hlgs.hlc.edu.tw/s/AKfycbzS29sVfv6vUKcXY8zhHl8XZKU52VfvjxzqeEQACrAufS7JiWOexlIYgyfgtCusAVJt/exec "GAS Station")，裡頭也許會有一些能幫助您的工具、程式，甚至是提供您創意的靈感。如果您願意的話，也非常樂意接受您的[打賞](https://p.ecpay.com.tw/36FF207 "打賞")。❤️  
Copyright (c) 2025 Chang, Chia-Cheng 張家誠
